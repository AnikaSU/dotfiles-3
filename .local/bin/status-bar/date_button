#! /bin/zsh

year=$(date +"%Y")
remains=$((($(date +%s --date "$year-12-31")-$(date +%s))/(3600*24)))
cmd=$(remind -c+ ~/docs/TODO/Trabajo.rem)

calendar() {
    echo "Eventos para la semana $(date +'%W') del 2020." > /tmp/calendar.txt
    remind -c+ ~/docs/TODO/Trabajo.rem >> /tmp/calendar.txt
    todotxt ls >> /tmp/calendar.txt
    alacritty --class 'calendar.txt' -t 'Agenda' -e less /tmp/calendar.txt
    rm -r /tmp/calendar.txt 
}

launch() {
    if [ -e /tmp/calendar.txt ]; then
        kill $(pgrep -a alacritty | grep Agenda | awk -F' ' '{print $1}')
    else
        calendar
    fi
}

case "$1" in
#    3) emacsclient -c -F '(quote (name . "agenda") (width  . 100) (height . 35) (left . 250) (top . 60))' -n -e "(agenda-frame)" ;;
   1) launch;;
   3) notify-send -i "Calendar" -a "Hoy es..." "$(date +"...%A %d de %B de %Y.%n Han pasado %j días y quedan $remains dias para acabar el año ")"  ;;
esac

